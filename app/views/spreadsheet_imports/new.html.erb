<%= render PageHeaderComponent.new(title: "Import Spreadsheet") %>

<div class="max-w-2xl">
  <div class="bg-white rounded-lg border border-gray-200 p-6">
    <p class="text-sm text-gray-600 mb-6">
      Upload your seed inventory Excel spreadsheet (.xlsx) to import your data into Ceres.
      The spreadsheet should have tabs for each plant type (Vegetables, Grains, Herbs, Flowers, Cover Crops)
      with columns for variety name, seed source, year purchased, germination data, and notes.
    </p>

    <% if @import.errors.any? %>
      <div class="mb-6 px-4 py-3 rounded-md bg-red-50 text-red-800 text-sm">
        <ul class="list-disc list-inside">
          <% @import.errors.full_messages.each do |message| %>
            <li><%= message %></li>
          <% end %>
        </ul>
      </div>
    <% end %>

    <%= form_with model: @import, html: { multipart: true } do |f| %>
      <div class="mb-6">
        <label class="block text-sm font-medium text-gray-700 mb-2">
          Excel File (.xlsx)
        </label>
        <div class="mt-1"
             data-controller="file-upload"
             data-file-upload-accept-value=".xlsx">
          <%= f.file_field :file,
                accept: ".xlsx",
                class: "block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-medium file:bg-emerald-50 file:text-emerald-700 hover:file:bg-emerald-100",
                data: { action: "file-upload#validate", file_upload_target: "input" } %>
          <p class="mt-1 text-xs text-gray-500" data-file-upload-target="message">
            Only .xlsx files are accepted
          </p>
        </div>
      </div>

      <div class="flex items-center gap-4">
        <%= f.submit "Upload & Parse",
              class: "inline-flex items-center px-4 py-2 bg-emerald-600 text-white text-sm font-medium rounded-md hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500 cursor-pointer" %>
        <%= link_to "Cancel", root_path,
              class: "text-sm text-gray-600 hover:text-gray-800" %>
      </div>
    <% end %>
  </div>
</div>
